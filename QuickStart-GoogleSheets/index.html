<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Simple page to show data from Google spreadsheet using Google SpreadSheet API using Bootstrap 5">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">


    <!-- Custom styles for this template -->
    <link href="cover.css" rel="stylesheet">
    <title>Google Sheets API Quickstart</title>
    <meta charset="utf-8" />
    <style>
        th {
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.15);
            padding: 10px 15px;
            font-family: Verdana, Geneva, Tahoma, sans-serif;
            background-color: #009879;
        }
        
        td {
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.15);
            border-collapse: collapse;
            font-size: 0.9em;
            padding: 5px 5px;
            text-align: left;
            min-width: 100px;
            border-bottom: 1px solid #dddddd;
        }
    </style>
</head>

<body class="text-center">
    <div class="cover-container d-flex h-100 p-3 mx-auto flex-column">
        <header class="masthead mb-auto">
            <div class="inner">
                <h3 class="masthead-brand">Collection Demo</h3>
                <nav class="nav nav-masthead justify-content-center">
                    <a class="nav-link active" href="#">Home</a>
                    <a class="nav-link" href="https://developers.google.com/sheets/api/guides/concepts">Reference</a>
                </nav>
            </div>
        </header>

        <!--Add buttons to initiate auth sequence and sign out-->
        <button id="authorize_button" style="display: none;">Authorize</button>
        <button id="signout_button" style="display: none;">Sign Out</button>

        <span id="content"></span>
        <pre id="precontent" style="white-space: pre-wrap;"></pre>

        <script type="text/javascript">
            // Client ID and API key from the Developer Console
            var CLIENT_ID = '263242106001-bdbcefem3l8msrnsc2dhrv6d8uvkkimi.apps.googleusercontent.com';
            var API_KEY = 'AIzaSyBi2OfvXGuFr6J8bsrWa76V99vV8Qy190o';

            // Array of API discovery doc URLs for APIs used by the quickstart
            var DISCOVERY_DOCS = ["https://sheets.googleapis.com/$discovery/rest?version=v4"];

            // Authorization scopes required by the API; multiple scopes can be
            // included, separated by spaces.
            var SCOPES = "https://www.googleapis.com/auth/spreadsheets.readonly";

            var authorizeButton = document.getElementById('authorize_button');
            var signoutButton = document.getElementById('signout_button');

            /**
             *  On load, called to load the auth2 library and API client library.
             */
            function handleClientLoad() {
                gapi.load('client:auth2', initClient);
            }

            /**
             *  Initializes the API client library and sets up sign-in state
             *  listeners.
             */
            function initClient() {
                gapi.client.init({
                    apiKey: API_KEY,
                    clientId: CLIENT_ID,
                    discoveryDocs: DISCOVERY_DOCS,
                    scope: SCOPES
                }).then(function() {
                    // Listen for sign-in state changes.
                    gapi.auth2.getAuthInstance().isSignedIn.listen(updateSigninStatus);

                    // Handle the initial sign-in state.
                    updateSigninStatus(gapi.auth2.getAuthInstance().isSignedIn.get());
                    authorizeButton.onclick = handleAuthClick;
                    signoutButton.onclick = handleSignoutClick;
                }, function(error) {
                    appendPre(JSON.stringify(error, null, 2));
                });
            }

            /**
             *  Called when the signed in status changes, to update the UI
             *  appropriately. After a sign-in, the API is called.
             */
            function updateSigninStatus(isSignedIn) {
                if (isSignedIn) {
                    authorizeButton.style.display = 'none';
                    signoutButton.style.display = 'block';
                    listMajors();
                } else {
                    authorizeButton.style.display = 'block';
                    signoutButton.style.display = 'none';
                }
            }

            /**
             *  Sign in the user upon button click.
             */
            function handleAuthClick(event) {
                gapi.auth2.getAuthInstance().signIn();
            }

            /**
             *  Sign out the user upon button click.
             */
            function handleSignoutClick(event) {
                gapi.auth2.getAuthInstance().signOut();
            }

            /**
             * Append a pre element to the body containing the given message
             * as its text node. Used to display the results of the API call.
             *
             * @param {string} message Text to be placed in pre element.
             */
            function appendRow(table, elements, tag) {
                //fix this hover  
                //table.style.class = "table table-hover";
                //table.setAttribute("class","table table-hover") 
                var row = document.createElement('tr')
                elements.forEach(function(e) {
                    var cell = document.createElement(tag || 'td')
                    cell.href = e;
                    cell.Title = e;
                    if (typeof e === 'string') {
                        cell.textContent = e;
                    } else {
                        cell.appendChild(e)
                    }
                    //cell.appendChild(document.createTextNode(e))
                    row.appendChild(cell)
                })
                table.appendChild(row)
            }


            var file = {
                name: 'hello',
                viewedByMeTime: '2017-03-11 T0 1:40:31.000Z',
                webViewLink: 'https://docs.google.com/spreadsheets/d/1C_T-fw_dhRX_C2Mk-H04LHg4lB8sErYCbZ-SS4wZXHI/edit?usp=sharing',
                quotaBytesUsed: 0
            }


            var table = document.getElementById('content')


            // Create header row
            appendRow(table, ['Name', 'Date', 'Link', 'Size'], 'th')

            // Create data row
            appendRow(table, [
                file.name,
                file.viewedByMeTime.split('.')[0],
                'this link ðŸ‘‡',
                file.quotaBytesUsed + ' bytes'
            ])

            // Create data row
            appendRow(table, [
                file.name,
                file.viewedByMeTime.split('.')[0],
                'this link ðŸ‘‡',
                file.quotaBytesUsed + ' bytes'
            ])

            // Create data row
            appendRow(table, [
                file.name,
                file.viewedByMeTime.split('.')[0],
                'this link ðŸ‘‡',
                file.quotaBytesUsed + ' bytes'
            ])

            function appendURL(table, elements, tag) {
                var row = document.createElement('tr')
                elements.forEach(function(e) {
                    var cell = document.createElement(tag || 'td')
                    if (typeof e === 'string') {
                        cell.textContent = e;
                    } else {
                        cell.appendChild(e)
                    }
                    //cell.appendChild(document.createTextNode(e))
                    row.appendChild(cell)
                })
                table.appendChild(row)
            }


            var file2 = {
                name: 'hello',
                viewedByMeTime: '2017-03-11 T0 1:40:31.000Z',
                webViewLink: 'https://docs.google.com/spreadsheets/d/1C_T-fw_dhRX_C2Mk-H04LHg4lB8sErYCbZ-SS4wZXHI/edit?usp=sharing',
                quotaBytesUsed: 0
            }

            appendRow(table, [
                file2.name,
                file2.viewedByMeTime.split('.')[0],
                file2.webViewLink,
                file2.quotaBytesUsed + ' bytes'
            ], 'a')


            //& lt; a href =& quot; about.html & quot;& gt;
            function appendPre(message) {
                var pre = document.getElementById('precontent');
                var textContent = document.createTextNode(message + '\n');
                pre.appendChild(textContent);
            }
            /**
             * Print the names and majors of students in a sample spreadsheet:
             * https://docs.google.com/spreadsheets/d/1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms/edit
             */
            function listMajors() {
                gapi.client.sheets.spreadsheets.values.get({
                    spreadsheetId: '1C_T-fw_dhRX_C2Mk-H04LHg4lB8sErYCbZ-SS4wZXHI',
                    range: 'Sheet1!A1:G10',
                }).then(function(response) {
                    var range = response.result;
                    if (range.values.length > 0) {
                        appendPre('row, col');
                        for (i = 0; i < range.values.length; i++) {
                            var row = range.values[i];
                            // Print columns A and E, which correspond to indices 0 and 4.
                            appendPre(row[i]);
                            appendPre(row);
                        }
                    } else {
                        appendPre('No data found.');
                    }
                }, function(response) {
                    appendPre('Error: ' + response.result.error.message);
                });
            }
        </script>

        <script async defer src="https://apis.google.com/js/api.js" onload="this.onload=function(){};handleClientLoad()" onreadystatechange="if (this.readyState === 'complete') this.onload()">
        </script>

    </div>
    <footer class="mastfoot mt-auto">
        <div class="inner">
            <p>Cover template for <a href="https://getbootstrap.com/">Bootstrap</a>, by <a href="https://twitter.com/mdo">@mdo</a>.</p>
        </div>
    </footer>
    <!-- Optional JavaScript; choose one of the two! -->

    <!-- Option 1: Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>

    <!-- Option 2: Separate Popper and Bootstrap JS -->
    <!--
        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>
        -->
</body>

</html>